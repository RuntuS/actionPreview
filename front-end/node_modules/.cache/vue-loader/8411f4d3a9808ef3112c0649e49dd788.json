{"remainingRequest":"D:\\actionPreview\\front-end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\actionPreview\\front-end\\src\\components\\pubInf\\pubInfBox.vue?vue&type=style&index=0&id=b5407e28&scoped=true&lang=css&","dependencies":[{"path":"D:\\actionPreview\\front-end\\src\\components\\pubInf\\pubInfBox.vue","mtime":1581757454182},{"path":"D:\\actionPreview\\front-end\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\actionPreview\\front-end\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\actionPreview\\front-end\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\actionPreview\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\actionPreview\\front-end\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKI3B1YkluZkJveHsKICAgIGJvcmRlcjogMXB4IHNvbGlkIHJlZDsKCn0KCi5OYXZpZ2F0aW9uQm94ewogICAgYm9yZGVyOjFweCBzb2xpZCByZWQ7CiAgICB3aWR0aDogMTAwJTsKfQo="},{"version":3,"sources":["pubInfBox.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiOA;AACA;;AAEA;;AAEA;AACA;AACA;AACA","file":"pubInfBox.vue","sourceRoot":"src/components/pubInf","sourcesContent":["<template>\n    <div >\n        <Row id=\"searchBox\">\n            <Input search placeholder=\"搜索活动信息（请输入活动标题)\" v-model=\"searchedInf\" />\n        </Row>\n\n        <Row id=\"pubInfBox\">\n            <Table border :columns=\"columns\" :data=\"pageNeedData.data1\" >\n            <template slot=\"action\" slot-scope=\"{row , index}\">\n                <Button type=\"primary\" @click=\"giveRow(index)\">详细页面</Button>\n            </template>\n            </Table>\n        </Row>\n\n        <Row class=\"NavigationBox\">\n            <Col span=\"16\" >\n                <Page :total=\"pageNum\" show-elevator  @on-change=\"currentPage\"/>\n            </Col>\n            <Col span=\"8\">\n                <Button type=\"primary\"  @click=\"exportData()\"><Icon type=\"ios-download-outline\"></Icon> Export source data</Button>\n            </Col>\n        </Row>\n\n    </div>\n</template>\n\n<script>\n    export default {\n        name: \"pubInfBox\",\n        data(){\n            return {\n                columns : [\n                    {\n                        title : \"活动标题\",\n                        key : \"actTitle\"\n                    },\n                    {\n                        title: \"活动时间\",\n                        key : \"actDate\"\n                    },\n                    {\n                        title: \"活动地点\",\n                        key : \"actPlace\"\n                    },\n                    {\n                        title: \"发布活动的老师\",\n                        key : \"teacherName\",\n                        width: 150\n                    },\n                    {\n                        title: \"活动详情\",\n                        slot : 'action',\n                        align : \"center\",\n                        // key : \"Inf\",\n                        width : 150\n                    }\n                ],\n                //页面需要的data\n                pageNeedData : {\n                    data1 : [\n\n                    ],\n                    firstResData : [ //首次响应获得的data\n\n                    ]\n                },\n\n                pageNum : 0,\n                currentPageVar : 1,\n                index : 0,\n                searchedInf : \"\" ,//搜索框的数值\n                originPageNumber : 0 //这个主要是做缓存，存储没有索引信息情况下的页数\n            }\n        },\n\n        methods : {\n\n            /*****必要函数信息*****/\n            //日期规格化函数\n            normalizingDate(middleData) {\n                middleData.forEach(x => { //对时间消息进行处理\n                    let array = x.actDate.split(\" \");\n                    x.actDate = array[0]+\" \"+array[1]+\"-\"+array[2];\n                });\n                return middleData;\n            },\n\n            computingPages(totalPages){\n                if (totalPages <= 3) //暂时先用三来代替\n                {\n                    return 10;\n                }\n                else\n                {\n                    return Math.ceil(totalPages/3) * 10;//Math.ceil->向上取整\n                }\n            },\n\n\n\n            //下面是需要进行响应请求的函数\n            //点击页面的响应\n            currentPage(page){\n\n                this.currentPageVar = page;\n                if(this.searchedInf === null) //当搜索框没有值的时候，进行这种请求\n                {\n                    this.$request.get('/actInf/page',{\n                        params : {\n                            page : page\n                        }\n                    }).then((result) => {\n                        let middleData = result.data;//middleData是中间数组，不用管\n                        this.pageNeedData.data1 = this.normalizingDate(middleData);\n                    }).catch(err => {\n                        console.log(err);\n                    })\n                }\n\n                else{\n                    this.$request.get('/actInf/search/page',{\n                        params : {\n                            searchedInf : this.searchedInf,\n                            currentPage : page\n                        }\n                    }).then((result) => {\n                        console.log(result.data);\n                        let middleData = result.data;\n                        this.pageNeedData.data1 = this.normalizingDate(middleData);\n                    }).catch((err) => {\n                        console.log(err);\n                    })\n                }\n            },\n\n            //Excel表格导出\n            exportData(){\n                this.$request.get(\"/excel/action-Inf\")\n                    .then((result) => {\n                        console.log(`处理结果${result}`);\n                    }).catch((err) => {\n                    console.log(err);\n                })\n            },\n\n\n            //路由跳转函数\n            giveRow(index){\n                console.log(index);\n                this.$router.push({path :\"/actInf/moreInf\" , query : { actId : this.pageNeedData.data1[index].actionId}});\n            },\n\n\n\n        },\n\n        //初始化的响应\n        created() {\n            this.$request.get(\"/actInf\",{\n            }).then((result) => {\n\n                let totalNumber = 0;\n                console.log(result);\n                if (result.data.status === \"fail\")\n                {\n                    alert(\"登录已过期，请重新登录!\");\n                    this.$router.push(\"/login\");\n                }\n                else\n                {\n                    this.$store.state.teaName = result.data.teacherName;//设置教师名称\n                    totalNumber = result.data.actionNumber; //一共的页数，前端进行\n                    this.pageNum = this.computingPages(totalNumber); //计算页数\n                    this.originPageNumber = this.pageNum;//缓存\n                    console.log(this.originPageNumber);\n\n                    this.pageNeedData.data1 = this.normalizingDate(result.data.data); //日期规格化\n                    this.pageNeedData.firstResData = [...this.pageNeedData.data1];//数组深度拷贝(解决引用类型问题)\n                }\n\n            }).catch((err) => {\n                console.log(err);\n            });\n        },\n\n\n        watch : { //实时搜索\n            searchedInf : function () {\n                let searchedInf = this.searchedInf;\n                if(searchedInf === null)//索引框为空的时候，不用请求，直接用本地缓存值\n                {\n                    console.log(this.originPageNumber);\n                    this.pageNeedData.data1 = [...this.pageNeedData.firstResData];\n                    this.pageNum = this.originPageNumber;\n                }\n                else\n                { //当索引框不为空的时候的请求\n                    this.$request.get(\"/actInf/search\",{\n                        params : {\n                            searchedInf : searchedInf\n                        }\n                    }).then((result) => {\n                        console.log(result.data);\n                        if (result.data === null)\n                        {\n                            this.pageNeedData.data1 = [...this.pageNeedData.firstResData];//为0的时候，把对应数据拷贝进去\n                        }\n                        else\n                        {\n                            console.log(result.data);\n                            this.pageNum = this.computingPages(result.data.pageNum);//进行搜索页数计算\n                            this.pageNeedData.data1 = result.data.searchedData;\n                            // this.pageNeedData.data1 = result.data;\n                        }\n                    }).catch((err) => {\n                        console.log(err);\n                    })\n                }//else\n\n            }\n        }\n    }\n</script>\n\n<style scoped>\n#pubInfBox{\n    border: 1px solid red;\n\n}\n\n.NavigationBox{\n    border:1px solid red;\n    width: 100%;\n}\n</style>"]}]}